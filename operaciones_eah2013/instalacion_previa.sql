CREATE DATABASE eah2013_desa_db  WITH OWNER = tedede_owner       ENCODING = 'UTF8'       TABLESPACE = pg_default       LC_COLLATE = 'Spanish, Argentina'       LC_CTYPE = 'Spanish, Argentina'       CONNECTION LIMIT = -1;GRANT all ON DATABASE eah2013_desa_db TO tedede_php;\c eah2013_desa_db-- Levantamos el backup al día de hoy de la base de datos de la eah2012.-- borré a mano las tablas de his (menos las que se necesitan)delete from his.his_inconsistencias;delete from his.his_respuestas;delete from his.modificaciones;-- borramos a mano his_anterior, encu_anterior y yeah2010-- Creamos el esquema yeah2012 para los datos del 2012CREATE SCHEMA eah2012  AUTHORIZATION yeahowner;GRANT ALL ON SCHEMA eah2012 TO yeahowner;GRANT USAGE ON SCHEMA eah2012 TO yeah_mues_campo;GRANT USAGE ON SCHEMA eah2012 TO yeah_test;GRANT USAGE ON SCHEMA eah2012 TO yeah_solo_lectura_formularios;-- No borro de las tablas de datos: (tem_enc between 311000 and 311099 or tem_enc between 512000 and 512099 or tem_enc between 100000 and 100099)delete from encu.tem where not (tem_enc between 311000 and 311099 or tem_enc between 512000 and 512099 or tem_enc between 100000 and 100099);delete from encu.plana_tem_ where not (pla_enc between 311000 and 311099 or pla_enc between 512000 and 512099 or pla_enc between 100000 and 100099);delete from encu.plana_i1_ where not (pla_enc between 311000 and 311099 or pla_enc between 512000 and 512099 or pla_enc between 100000 and 100099);delete from encu.plana_a1_ where not (pla_enc between 311000 and 311099 or pla_enc between 512000 and 512099 or pla_enc between 100000 and 100099);delete from encu.plana_a1_x where not (pla_enc between 311000 and 311099 or pla_enc between 512000 and 512099 or pla_enc between 100000 and 100099);delete from encu.respuestas where not (res_enc between 311000 and 311099 or res_enc between 512000 and 512099 or res_enc between 100000 and 100099) and res_for<>'S1';delete from encu.claves where not (cla_enc between 311000 and 311099 or cla_enc between 512000 and 512099 or cla_enc between 100000 and 100099) and cla_for<>'S1';delete from encu.anoenc where not (anoenc_enc between 311000 and 311099 or anoenc_enc between 512000 and 512099 or anoenc_enc between 100000 and 100099);alter table encu.anoenc    set schema eah2012;-- Quiero borrar la tabla tiempo_logicoselect 'alter table '||s.constraint_schema||'.'||s.table_name||' drop constraint '||s.constraint_name||';'  from information_schema.constraint_column_usage t inner join information_schema.table_constraints s    on t.constraint_catalog=s.constraint_catalog      and t.constraint_schema=s.constraint_schema     and t.constraint_name=s.constraint_name  where t.column_name='tlg_tlg' and s.constraint_name<>'tiempo_logico_pkey';-- Antes tengo que borrar las FK  alter table eah2012.tiempo_logico drop constraint tiempo_logico_pkey;alter table eah2012.ano_con drop constraint ano_con_tiempo_logico_fk;alter table eah2012.anoenc drop constraint anoenc_tiempo_logico_fk;alter table eah2012.bloques drop constraint bloques_tiempo_logico_fk;alter table eah2012.bolsas drop constraint bolsas_tiempo_logico_fk;alter table eah2012.claves drop constraint claves_tiempo_logico_fk;alter table eah2012.con_opc drop constraint con_opc_tiempo_logico_fk;alter table eah2012.con_var drop constraint con_var_tiempo_logico_fk;alter table eah2012.consistencias drop constraint consistencias_tiempo_logico_fk;alter table eah2012.estados_ingreso drop constraint estados_ingreso_tiempo_logico_fk;alter table eah2012.excepciones drop constraint excepciones_tiempo_logico_fk;alter table eah2012.filtros drop constraint filtros_tiempo_logico_fk;alter table eah2012.formularios drop constraint formularios_tiempo_logico_fk;alter table eah2012.inconsistencias drop constraint inconsistencias_tiempo_logico_fk;alter table eah2012.matrices drop constraint matrices_tiempo_logico_fk;alter table eah2012.opciones drop constraint opciones_tiempo_logico_fk;alter table eah2012.operativos drop constraint operativos_tiempo_logico_fk;alter table eah2012.personal drop constraint personal_tiempo_logico_fk;alter table eah2012.plana_a1_ drop constraint plana_a1__tiempo_logico_fk;alter table eah2012.plana_a1_x drop constraint plana_a1_x_tiempo_logico_fk;alter table eah2012.plana_i1_ drop constraint plana_i1__tiempo_logico_fk;alter table eah2012.plana_s1_ drop constraint plana_s1__tiempo_logico_fk;alter table eah2012.plana_s1_p drop constraint plana_s1_p_tiempo_logico_fk;alter table eah2012.plana_tem_ drop constraint plana_tem__tiempo_logico_fk;alter table eah2012.preguntas drop constraint preguntas_tiempo_logico_fk;alter table eah2012.relaciones drop constraint relaciones_tiempo_logico_fk;alter table eah2012.respuestas drop constraint respuestas_tiempo_logico_fk;alter table eah2012.rol_rol drop constraint rol_rol_tiempo_logico_fk;alter table eah2012.roles drop constraint roles_tiempo_logico_fk;alter table eah2012.saltos drop constraint saltos_tiempo_logico_fk;alter table eah2012.tem drop constraint tem_tiempo_logico_fk;alter table eah2012.ua drop constraint ua_tiempo_logico_fk;alter table eah2012.usuarios drop constraint usuarios_tiempo_logico_fk;alter table eah2012.variables drop constraint variables_tiempo_logico_fk;